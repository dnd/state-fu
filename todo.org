# +STARTUP:hidestars
# TODO / DEVELOPMENT NOTES

# Note: most of the value of this kind of list is in the act of
# writing it.

# i.e., don't expect it to be up to date.
==================================================
* TODOs

** global hooks for both state & event hooks

lathe do
  all_states do
    requires
    *hooks
  end

  all_events do
    requires
    *hooks
  end

end

** support :ALL, :only and :except - lathe.event, .states
*** when using event.to and .from
*** when defining hooks on multiple events / states (NOT globally)

** configurable method definitions for object / lathe

** lathe( event ) .from should support hash syntax:

   event( :go, :from => { :intro => :outro } )
   event( :go, :from => { :intro => [:outro, :exit] } )

** spec / code for introspection of unmet requirements for transitions
** spec / code for introspection of transitionHalted exceptions during a transition
** test-only transitions - what would this do exactly?
*** enclose stuff that's destructive in a block which only executes if it's not a test transition
    i.e, destructively do .... end

** ensure event methods are callable before calling state_fu!
*** use method_missing to call .state_fu! then try again / super

** more logging

** refactor transition unit spec to integration & unit specs
** update account example integration spec
** write cheat / intro / examples
** auto transitions and default arguments
*** find permissable events and try firing them; repeat until deadlock

====================================================

* Bugs
** Machines are not inherited. Is this a bug?
   To make them inheritable we'd be back to needing a Binding
   or some other substantial complexity.
   I don't think it's worth it.

* Decisions
** removed ability to have procs as origin / target states
*** not worth the complexity / fugly code
*** can use guard conditions on states to test if they're available
*** performance
*** can use conditions on events to check if something's valid at transition time

* Wishlist
** test storing meta-information in options for integration with eg Rails controllers, views
** Rails helpers for views etc? Tie-in to controller stuff?
** conditionals - guards & test transitions
*** needs / requires
** Persistence w/ Marshall.dump / reload ;; json / yaml ;;
   Marshal works a treat as long as you got no procs
*** useful though?
*** other formats?
**** YAML
**** JSON
**** nested hash as basic interchange format?
*** avoid procs if possible, or provide alternatives, to keep these options open
*** serialize / deserialize allows easy deep-object copies

** Documentation
*** high-level overviews
**** of the API / syntax
**** of the behind-the-scenes action and how classes relate

* requirements, etc should be orderable
** auto-order-by :position option
** array mixins to help move stuff around

** Machines should
*** be deep-copyable
**** store blocks passed to them in an array so that they can be replayed?
**** use a recorder pattern?
**** -> common interchange format? ie, hash / marshal.dump / yaml ?
*** cast to string / json / ... without looking like ass
*** able to generate dot / graphviz

** Class/object API
*** should be interchangeable

** Contexts
*** should be extensible by the user to create a custom DSL
**** how to work this into the DSL? Scope?

* Specs pending

* Code smells
** specs

* Other
** testing w/ heckle, rcov
** Cucumber
** benchmark / tune for performance
*** Cuc. for user-facing API; Rspec for internals?
